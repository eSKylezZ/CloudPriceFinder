document.addEventListener("DOMContentLoaded",()=>{const a=document.getElementById("sort-select"),l=document.getElementById("table-body"),p=document.getElementById("result-count");let d=Array.from(document.querySelectorAll(".instance-row")).map(t=>JSON.parse(t.dataset.instance||"{}")),o="ipv4_ipv6";a&&a.addEventListener("change",()=>{const[t,r]=a.value.split("-");f(t,r==="desc"?"desc":"asc")}),document.addEventListener("filtersChanged",t=>{const e=t.detail;e.networkOptions?.length===1?o=e.networkOptions[0]:o="ipv4_ipv6",u(e)});function f(t,r){const n=Array.from(document.querySelectorAll(".instance-row:not(.hidden)")).map(i=>JSON.parse(i.dataset.instance||"{}"));n.sort((i,g)=>{const c=i[t],m=g[t];if(c===m)return 0;const s=c<m?-1:1;return r==="asc"?s:-s}),v(n)}function u(t){const r=d.filter(e=>{if(t.providers?.length&&!t.providers.includes(e.provider))return!1;if(t.regions?.length){let n=!1;if(e.locationDetails&&Array.isArray(e.locationDetails)?n=e.locationDetails.some(i=>t.regions.includes(i.country)):e.regions&&Array.isArray(e.regions)&&(n=e.regions.some(i=>t.regions.includes(i))),!n)return!1}if(t.instanceTypes?.length&&!t.instanceTypes.includes(e.type))return!1;if(t.ipTypes?.length){const n=e.networkType||e.ipType;if(n&&!t.ipTypes.includes(n))return!1}if(t.networkOptions?.length){const n=e.networkType||e.networkOptions;if(n&&!t.networkOptions.includes(n))return!1}return!(e.vCPU<t.minVCPU||e.vCPU>t.maxVCPU||e.memoryGiB<t.minMemory||e.memoryGiB>t.maxMemory||e.priceUSD_hourly>t.maxPrice)});v(r),p&&(p.textContent=`${r.length} instances`)}function x(){document.querySelectorAll(".instance-row").forEach(t=>{const r=JSON.parse(t.dataset.instance||"{}");t.querySelector('[data-network-info="true"]');const e=t.querySelector(".pricing-mode-indicator"),n=t.querySelector(".pricing-description"),i=t.querySelector(".pricing-hourly"),g=t.querySelector(".pricing-monthly");if(r.networkOptions&&typeof r.networkOptions=="object"){const c=r.networkOptions[o];if(c&&c.available){if(e&&(e.textContent=o==="ipv6_only"?"IPv6-only":"IPv4 + IPv6",e.className=`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium pricing-mode-indicator ${o==="ipv6_only"?"bg-green-100 text-green-800":"bg-cyan-100 text-cyan-800"}`),n&&(o==="ipv6_only"&&c.savings?(n.textContent=`Saves â‚¬${c.savings.toFixed(2)}/month`,n.className="text-xs text-green-600 pricing-description"):(n.textContent=c.description||"Standard pricing",n.className="text-xs text-gray-500 pricing-description")),i&&c.hourly!==null){const m=i.querySelector(".pricing-value"),s=i.querySelector(".text-xs.text-orange-600");if(m){const y=c.priceRange?.hourly;if(y&&y.hasVariation){const S=new Intl.NumberFormat("en-US",{style:"currency",currency:"EUR",minimumFractionDigits:4}).format(y.min),h=new Intl.NumberFormat("en-US",{style:"currency",currency:"EUR",minimumFractionDigits:4}).format(y.max);m.textContent=`${S} - ${h}`,s&&(s.style.display="")}else m.textContent=new Intl.NumberFormat("en-US",{style:"currency",currency:"EUR",minimumFractionDigits:4}).format(c.hourly),s&&(s.style.display="none")}}if(g&&c.monthly!==null){const m=g.querySelector(".pricing-value"),s=g.querySelector(".text-xs.text-orange-600");if(m){const y=c.priceRange?.monthly;if(y&&y.hasVariation){const S=new Intl.NumberFormat("en-US",{style:"currency",currency:"EUR",minimumFractionDigits:2}).format(y.min),h=new Intl.NumberFormat("en-US",{style:"currency",currency:"EUR",minimumFractionDigits:2}).format(y.max);m.textContent=`${S} - ${h}`,s&&(s.style.display="")}else m.textContent=new Intl.NumberFormat("en-US",{style:"currency",currency:"EUR",minimumFractionDigits:2}).format(c.monthly),s&&(s.style.display="none")}}t.style.display=""}else o!=="all"&&o!=="ipv4_ipv6"&&(t.style.display="none")}})}function v(t){l&&(document.querySelectorAll(".instance-row").forEach(r=>{r.style.display="none"}),t.forEach(r=>{const e=Array.from(document.querySelectorAll(".instance-row")).find(n=>{const i=JSON.parse(n.dataset.instance||"{}");return i.instanceType===r.instanceType&&i.provider===r.provider});e&&(e.style.display="",l.appendChild(e))}),x())}});document.addEventListener("DOMContentLoaded",()=>{const a=document.getElementById("apply-filters"),l=document.getElementById("clear-filters");a&&a.addEventListener("click",q),l&&l.addEventListener("click",C)});function q(){const a=Array.from(document.querySelectorAll('input[name="provider"]:checked')).map(e=>e.value),l=Array.from(document.querySelectorAll('input[name="region"]:checked')).map(e=>e.value),p=Array.from(document.querySelectorAll('input[name="instanceType"]:checked')).map(e=>e.value),d=Array.from(document.querySelectorAll('input[name="ipType"]:checked')).map(e=>e.value),o=Array.from(document.querySelectorAll('input[name="networkOption"]:checked')).map(e=>e.value),f=parseInt(document.querySelector('input[name="minVCPU"]')?.value||"0"),u=parseInt(document.querySelector('input[name="maxVCPU"]')?.value||"999"),x=parseInt(document.querySelector('input[name="minMemory"]')?.value||"0"),v=parseInt(document.querySelector('input[name="maxMemory"]')?.value||"9999"),t=parseFloat(document.querySelector('input[name="maxPrice"]')?.value||"999"),r=new CustomEvent("filtersChanged",{detail:{providers:a,regions:l,instanceTypes:p,ipTypes:d,networkOptions:o,minVCPU:f,maxVCPU:u,minMemory:x,maxMemory:v,maxPrice:t}});document.dispatchEvent(r)}function C(){document.querySelectorAll('input[type="checkbox"]').forEach(f=>{const u=f;u.name==="region"?u.checked=u.value==="Germany"||u.value==="germany":u.checked=!0});const a=document.querySelector('input[name="minVCPU"]'),l=document.querySelector('input[name="maxVCPU"]'),p=document.querySelector('input[name="minMemory"]'),d=document.querySelector('input[name="maxMemory"]'),o=document.querySelector('input[name="maxPrice"]');a&&(a.value=a.min),l&&(l.value=l.max),p&&(p.value=p.min),d&&(d.value=d.max),o&&(o.value=o.max),q()}
