document.addEventListener("DOMContentLoaded",()=>{const i=document.getElementById("sort-select"),c=document.getElementById("pricing-mode-select"),y=document.getElementById("table-body"),d=document.getElementById("result-count");let p=Array.from(document.querySelectorAll(".instance-row")).map(e=>JSON.parse(e.dataset.instance||"{}")),s="ipv4_ipv6";i&&i.addEventListener("change",()=>{const[e,n]=i.value.split("-");x(e,n==="desc"?"desc":"asc")}),c&&c.addEventListener("change",()=>{s=c.value,v()}),document.addEventListener("filtersChanged",e=>{const t=e.detail;S(t)});function x(e,n){const r=Array.from(document.querySelectorAll(".instance-row:not(.hidden)")).map(l=>JSON.parse(l.dataset.instance||"{}"));r.sort((l,f)=>{const o=l[e],m=f[e];if(o===m)return 0;const a=o<m?-1:1;return n==="asc"?a:-a}),g(r)}function S(e){const n=p.filter(t=>{if(e.providers?.length&&!e.providers.includes(t.provider)||e.instanceTypes?.length&&!e.instanceTypes.includes(t.type))return!1;if(e.ipTypes?.length){const r=t.networkType||t.ipType;if(r&&!e.ipTypes.includes(r))return!1}if(e.networkOptions?.length){const r=t.networkType||t.networkOptions;if(r&&!e.networkOptions.includes(r))return!1}return!(t.vCPU<e.minVCPU||t.vCPU>e.maxVCPU||t.memoryGiB<e.minMemory||t.memoryGiB>e.maxMemory||t.priceUSD_hourly>e.maxPrice)});g(n),d&&(d.textContent=`${n.length} instances`)}function v(){document.querySelectorAll(".instance-row").forEach(e=>{const n=JSON.parse(e.dataset.instance||"{}");e.querySelector('[data-network-info="true"]');const t=e.querySelector(".pricing-mode-indicator"),r=e.querySelector(".pricing-description"),l=e.querySelector(".pricing-hourly"),f=e.querySelector(".pricing-monthly");if(n.networkOptions&&typeof n.networkOptions=="object"){const o=n.networkOptions[s];if(o&&o.available){if(t&&(t.textContent=s==="ipv6_only"?"IPv6-only":"IPv4 + IPv6",t.className=`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium pricing-mode-indicator ${s==="ipv6_only"?"bg-green-100 text-green-800":"bg-cyan-100 text-cyan-800"}`),r&&(s==="ipv6_only"&&o.savings?(r.textContent=`Saves â‚¬${o.savings.toFixed(2)}/month`,r.className="text-xs text-green-600 pricing-description"):(r.textContent=o.description||"Standard pricing",r.className="text-xs text-gray-500 pricing-description")),l&&o.hourly!==null){const m=l.querySelector(".pricing-value"),a=l.querySelector(".text-xs.text-orange-600");if(m){const u=o.priceRange?.hourly;if(u&&u.hasVariation){const h=new Intl.NumberFormat("en-US",{style:"currency",currency:"EUR",minimumFractionDigits:4}).format(u.min),q=new Intl.NumberFormat("en-US",{style:"currency",currency:"EUR",minimumFractionDigits:4}).format(u.max);m.textContent=`${h} - ${q}`,a&&(a.style.display="")}else m.textContent=new Intl.NumberFormat("en-US",{style:"currency",currency:"EUR",minimumFractionDigits:4}).format(o.hourly),a&&(a.style.display="none")}}if(f&&o.monthly!==null){const m=f.querySelector(".pricing-value"),a=f.querySelector(".text-xs.text-orange-600");if(m){const u=o.priceRange?.monthly;if(u&&u.hasVariation){const h=new Intl.NumberFormat("en-US",{style:"currency",currency:"EUR",minimumFractionDigits:2}).format(u.min),q=new Intl.NumberFormat("en-US",{style:"currency",currency:"EUR",minimumFractionDigits:2}).format(u.max);m.textContent=`${h} - ${q}`,a&&(a.style.display="")}else m.textContent=new Intl.NumberFormat("en-US",{style:"currency",currency:"EUR",minimumFractionDigits:2}).format(o.monthly),a&&(a.style.display="none")}}e.style.display=""}else s!=="all"&&s!=="ipv4_ipv6"&&(e.style.display="none")}})}function g(e){y&&(document.querySelectorAll(".instance-row").forEach(n=>{n.style.display="none"}),e.forEach(n=>{const t=Array.from(document.querySelectorAll(".instance-row")).find(r=>{const l=JSON.parse(r.dataset.instance||"{}");return l.instanceType===n.instanceType&&l.provider===n.provider});t&&(t.style.display="",y.appendChild(t))}),v())}});document.addEventListener("DOMContentLoaded",()=>{const i=document.getElementById("apply-filters"),c=document.getElementById("clear-filters");i&&i.addEventListener("click",E),c&&c.addEventListener("click",C)});function E(){const i=Array.from(document.querySelectorAll('input[name="provider"]:checked')).map(e=>e.value),c=Array.from(document.querySelectorAll('input[name="instanceType"]:checked')).map(e=>e.value),y=Array.from(document.querySelectorAll('input[name="ipType"]:checked')).map(e=>e.value),d=Array.from(document.querySelectorAll('input[name="networkOption"]:checked')).map(e=>e.value),p=parseInt(document.querySelector('input[name="minVCPU"]')?.value||"0"),s=parseInt(document.querySelector('input[name="maxVCPU"]')?.value||"999"),x=parseInt(document.querySelector('input[name="minMemory"]')?.value||"0"),S=parseInt(document.querySelector('input[name="maxMemory"]')?.value||"9999"),v=parseFloat(document.querySelector('input[name="maxPrice"]')?.value||"999"),g=new CustomEvent("filtersChanged",{detail:{providers:i,instanceTypes:c,ipTypes:y,networkOptions:d,minVCPU:p,maxVCPU:s,minMemory:x,maxMemory:S,maxPrice:v}});document.dispatchEvent(g)}function C(){document.querySelectorAll('input[type="checkbox"]').forEach(s=>{s.checked=!0});const i=document.querySelector('input[name="minVCPU"]'),c=document.querySelector('input[name="maxVCPU"]'),y=document.querySelector('input[name="minMemory"]'),d=document.querySelector('input[name="maxMemory"]'),p=document.querySelector('input[name="maxPrice"]');i&&(i.value=i.min),c&&(c.value=c.max),y&&(y.value=y.min),d&&(d.value=d.max),p&&(p.value=p.max),E()}
